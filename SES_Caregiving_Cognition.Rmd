---
title: "SES_Caregiving_Cognition"
author: "Arielle Keller"
date: "2/28/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(width=250)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lsr)
library(lme4)
library(lmerTest)
library(mediation)
library(ggcorrplot)
library(corrplot)
library(RColorBrewer)
library(glmnet)
library(mgcv)
library(gamm4)
library(readr)
library(effectsize)
library(broom)
library(knitr)
library(sjPlot)
```


# Load data
```{r}
nihtb<-read.table("/Users/askeller/Documents/Kellernet_PrelimAnalysis/NihTB/abcd_tbss01.txt",header=TRUE)
nihtb.baseline<-nihtb[nihtb$eventname=="baseline_year_1_arm_1",]
lmt<-read.table("/Users/askeller/Documents/Kellernet_PrelimAnalysis/Thomp/lmtp201.txt",header=TRUE)
lmt.baseline<-lmt[lmt$eventname=="baseline_year_1_arm_1",]
merged.data2 <- merge(nihtb.baseline,lmt.baseline[, c("subjectkey", setdiff(colnames(lmt.baseline),colnames(nihtb.baseline)))],by="subjectkey")
ravlt<-read.table("/Users/askeller/Documents/Kellernet_PrelimAnalysis/Thomp/abcd_ps01.txt",header=TRUE)
ravlt.baseline<-ravlt[ravlt$eventname=="baseline_year_1_arm_1",]
merged.data3 <- merge(merged.data2,ravlt.baseline[, c("subjectkey", setdiff(colnames(ravlt.baseline),colnames(merged.data2)))],by="subjectkey")
trauma<-read.table("/Users/askeller/Documents/Kellernet_PrelimAnalysis/Strife/abcd_ptsd01.txt",header=TRUE)
trauma.baseline<-trauma[trauma$eventname=="baseline_year_1_arm_1",]
combined.data <- merge(merged.data3,trauma.baseline[, c("subjectkey", setdiff(colnames(trauma.baseline),colnames(merged.data3)))],by="subjectkey")
```


# Organize behavioral data
```{r}
# Coerce data types
combined.data$nihtbx_flanker_uncorrected <- as.numeric(combined.data$nihtbx_flanker_uncorrected)
combined.data$nihtbx_picvocab_uncorrected <- as.numeric(combined.data$nihtbx_picvocab_uncorrected)
combined.data$nihtbx_list_uncorrected <- as.numeric(combined.data$nihtbx_list_uncorrected)
combined.data$nihtbx_pattern_uncorrected <- as.numeric(combined.data$nihtbx_pattern_uncorrected)
combined.data$nihtbx_cardsort_uncorrected <- as.numeric(combined.data$nihtbx_cardsort_uncorrected)
combined.data$nihtbx_picture_uncorrected <- as.numeric(combined.data$nihtbx_picture_uncorrected)
combined.data$nihtbx_reading_uncorrected <- as.numeric(combined.data$nihtbx_reading_uncorrected)
combined.data$lmt_scr_perc_correct <- as.numeric(combined.data$lmt_scr_perc_correct)
combined.data$pea_ravlt_sd_trial_i_tc <- as.numeric(combined.data$pea_ravlt_sd_trial_i_tc)
combined.data$pea_ravlt_sd_trial_ii_tc <- as.numeric(combined.data$pea_ravlt_sd_trial_ii_tc)
combined.data$pea_ravlt_sd_trial_iii_tc <- as.numeric(combined.data$pea_ravlt_sd_trial_iii_tc)
combined.data$pea_ravlt_sd_trial_iv_tc <- as.numeric(combined.data$pea_ravlt_sd_trial_iv_tc)
combined.data$pea_ravlt_sd_trial_v_tc <- as.numeric(combined.data$pea_ravlt_sd_trial_v_tc)
combined.data$interview_age <- as.numeric(combined.data$interview_age)

ind_pea_ravlt = c(which(names(combined.data)=="pea_ravlt_sd_trial_i_tc"),which(names(combined.data)=="pea_ravlt_sd_trial_ii_tc"),
	which(names(combined.data)=="pea_ravlt_sd_trial_iii_tc"),which(names(combined.data)=="pea_ravlt_sd_trial_iv_tc"),
	which(names(combined.data)=="pea_ravlt_sd_trial_v_tc")); names(combined.data)[ind_pea_ravlt]; summary(combined.data[,ind_pea_ravlt])
combined.data$pea_ravlt_ld = apply(combined.data[,ind_pea_ravlt],1,sum)

combined.data$pea_ravlt_ld <- as.numeric(combined.data$pea_ravlt_ld)

# Rename according to Thompson 2018 code
names(combined.data)[which(names(combined.data)=="nihtbx_picvocab_uncorrected")] = "PicVocab"
names(combined.data)[which(names(combined.data)=="nihtbx_flanker_uncorrected")] = "Flanker"
names(combined.data)[which(names(combined.data)=="nihtbx_list_uncorrected")] = "List"
names(combined.data)[which(names(combined.data)=="nihtbx_cardsort_uncorrected")] = "CardSort"
names(combined.data)[which(names(combined.data)=="nihtbx_pattern_uncorrected")] = "Pattern"
names(combined.data)[which(names(combined.data)=="nihtbx_picture_uncorrected")] = "Picture"
names(combined.data)[which(names(combined.data)=="nihtbx_reading_uncorrected")] = "Reading"
names(combined.data)[which(names(combined.data)=="pea_ravlt_ld")] = "RAVLT"
names(combined.data)[which(names(combined.data)=="lmt_scr_perc_correct")] = "LMT"
```


## Instead of calculating the Thompson factor scores ourselves, use the summary scores from DEAP
# also add in variables for residential income
```{r}
newdata<-readRDS("/Users/askeller/Documents/Kellernet_PrelimAnalysis/DEAP-data-download_ThompsonScores_ResFamIncome.rds")
newdata.baseline<-newdata[newdata$event_name=="baseline_year_1_arm_1",]
colnames(newdata.baseline)[1]<-"subjectkey"
all.data <- merge(combined.data,newdata.baseline[,c("subjectkey", setdiff(colnames(newdata.baseline),colnames(combined.data)))],by="subjectkey")

# # Calculate Thompson factor scores
# 
# combined.data$thompson_PC1 <- (0.754*combined.data$PicVocab)+(0.213*combined.data$Flanker)+(0.471*combined.data$List)+(0.205*combined.data$CardSort)+(0.015*combined.data$Pattern)+(0.012*combined.data$Picture)+(0.82*combined.data$Reading)+(0.306*combined.data$RAVLT)+(0.5*combined.data$LMT)
# 
# combined.data$thompson_PC2 <- (0.065*combined.data$PicVocab)+(0.712*combined.data$Flanker)+(0.148*combined.data$List)+(0.71*combined.data$CardSort)+(0.813*combined.data$Pattern)+(0.135*combined.data$Picture)+(0.12*combined.data$Reading)+(0.125*combined.data$RAVLT)+(0.299*combined.data$LMT)
# 
# combined.data$thompson_PC3 <- (0.19*combined.data$PicVocab)+(0.067*combined.data$Flanker)+(0.493*combined.data$List)+(0.232*combined.data$CardSort)+(0.085*combined.data$Pattern)+(0.863*combined.data$Picture)+(0.122*combined.data$Reading)+(0.712*combined.data$RAVLT)+(0.068*combined.data$LMT)
# 
# # Remove outliers
# mean_PC1 <- mean(combined.data$thompson_PC1,na.rm=TRUE)
# mean_PC2 <- mean(combined.data$thompson_PC2,na.rm=TRUE)
# mean_PC3 <- mean(combined.data$thompson_PC3,na.rm=TRUE)
# sd3_PC1 <- sd(combined.data$thompson_PC1,na.rm=TRUE)*3
# sd3_PC2 <- sd(combined.data$thompson_PC2,na.rm=TRUE)*3
# sd3_PC3 <- sd(combined.data$thompson_PC3,na.rm=TRUE)*3
# sum(combined.data$thompson_PC1 >= mean_PC1+sd3_PC1,na.rm=TRUE) # 8 outliers
# sum(combined.data$thompson_PC2 >= mean_PC2+sd3_PC2,na.rm=TRUE) # 2 outliers
# sum(combined.data$thompson_PC3 >= mean_PC3+sd3_PC3,na.rm=TRUE) # 0 outliers
# sum(combined.data$thompson_PC1 <= mean_PC1-sd3_PC1,na.rm=TRUE) # 10 outliers
# sum(combined.data$thompson_PC2 <= mean_PC2-sd3_PC2,na.rm=TRUE) # 17 outliers
# sum(combined.data$thompson_PC3 <= mean_PC3-sd3_PC3,na.rm=TRUE) # 7 outliers
# combined.data.noOutliers <- combined.data[combined.data$thompson_PC1>(mean_PC1-sd3_PC1) & combined.data$thompson_PC1<(mean_PC1+sd3_PC1) & combined.data$thompson_PC2>(mean_PC2-sd3_PC2) & combined.data$thompson_PC2<(mean_PC2+sd3_PC2) & combined.data$thompson_PC3>(mean_PC3-sd3_PC3) & combined.data$thompson_PC3<(mean_PC3+sd3_PC3),]


```


# Add in Parental Warmth and Monitoring
```{r}
warmth <-read.table("/Users/askeller/Documents/Kellernet_PrelimAnalysis/neglect/crpbi01.txt",header=TRUE)
warmth.baseline<-warmth[warmth$eventname=="baseline_year_1_arm_1",]
monitoring.data <-read.table("/Users/askeller/Documents/Kellernet_PrelimAnalysis/neglect/pmq01.txt",header=TRUE)
monitoring.baseline<-monitoring.data[monitoring.data$eventname=="baseline_year_1_arm_1",]
parenting.data <- merge(warmth.baseline,monitoring.baseline[, c("subjectkey", setdiff(colnames(monitoring.baseline),colnames(warmth.baseline)))],by="subjectkey")

abcd.data<-merge(all.data,parenting.data[,c("subjectkey", setdiff(colnames(parenting.data),colnames(all.data)))],by="subjectkey")


abcd.data$warmth <- rowMeans(data.frame(as.numeric(abcd.data$crpbi_parent1_y),as.numeric(abcd.data$crpbi_parent2_y),as.numeric(abcd.data$crpbi_parent3_y),as.numeric(abcd.data$crpbi_parent4_y),as.numeric(abcd.data$crpbi_parent5_y)))

abcd.data$monitoring <- rowMeans(data.frame(as.numeric(abcd.data$parent_monitor_q1_y),as.numeric(abcd.data$parent_monitor_q2_y),as.numeric(abcd.data$parent_monitor_q3_y),as.numeric(abcd.data$parent_monitor_q4_y),as.numeric(abcd.data$parent_monitor_q5_y)))

# make sure monitoring and acceptance are on the same scale so we can compare effect sizes:
#abcd.data$warmth<-(((abcd.data$warmth-1)/2)*4)+1

# Replace this rescaling with z-scoring ^
abcd.data$warmth<-((abcd.data$warmth-mean(abcd.data$warmth,na.rm=TRUE))/sd(abcd.data$warmth,na.rm=TRUE))
abcd.data$monitoring<-((abcd.data$monitoring-mean(abcd.data$monitoring,na.rm=TRUE))/sd(abcd.data$monitoring,na.rm=TRUE))

# n=10,966
```


# Add in Family and Site covariates
```{r}
# Remember to add in this variable about family structure so we can use it as a covariate
family <-read.table("/Users/askeller/Documents/Kellernet_PrelimAnalysis/ses/acspsw03.txt",header=TRUE)
family.baseline<-family[family$eventname=="baseline_year_1_arm_1",]
abcd.data.almost <- merge(abcd.data,family.baseline[, c("subjectkey", setdiff(colnames(family.baseline),colnames(abcd.data)))],by="subjectkey")

# also add in the variable for site ID to use as a covariate
site_info <- readRDS("/Users/askeller/Documents/Kellernet_PrelimAnalysis/DEAP-siteID.rds")
site.baseline<-site_info[site_info$event_name=="baseline_year_1_arm_1",]
colnames(site.baseline)[1]<-"subjectkey"
abcd.data.almost2 <- merge(abcd.data.almost,site.baseline[,c("subjectkey", setdiff(colnames(site.baseline),colnames(abcd.data.almost)))],by="subjectkey")

# exclude participants with missing cognitive data
abcd.data.almost3<-abcd.data.almost2[complete.cases(abcd.data.almost2$neurocog_pc1.bl),] # drop 11,875 to 11,039
abcd.data.almost4<-abcd.data.almost3[complete.cases(abcd.data.almost3$neurocog_pc2.bl),]
abcd.data.almost5<-abcd.data.almost4[complete.cases(abcd.data.almost4$neurocog_pc3.bl),] # still 11,039

# exclude for missing warmth/monitoring data
abcd.data.almost6<-abcd.data.almost5[complete.cases(abcd.data.almost5$warmth),] # drop to 11,018
abcd.data.almost7<-abcd.data.almost6[complete.cases(abcd.data.almost6$monitoring),] # drop to 11,016

# exclude for missing household income, residential income, and parents' education
abcd.data.almost8<-abcd.data.almost7[complete.cases(abcd.data.almost7$reshist_addr1_adi_income),] # drop to 10,381
abcd.data.almost9<-abcd.data.almost8[complete.cases(abcd.data.almost8$household.income),] # drop to 9,521
abcd.data.almost10<-abcd.data.almost9[complete.cases(abcd.data.almost9$high.educ),] # drop to 9,517

# for simplicity, rename thompson variables
colnames(abcd.data.almost10)<-gsub("neurocog_pc1.bl","thompson_PC1",colnames(abcd.data.almost10))
colnames(abcd.data.almost10)<-gsub("neurocog_pc2.bl","thompson_PC2",colnames(abcd.data.almost10))
colnames(abcd.data.almost10)<-gsub("neurocog_pc3.bl","thompson_PC3",colnames(abcd.data.almost10))
```


# Exclude cognitive outliers
```{r}
abcd.data.almost11<-abcd.data.almost10[abcd.data.almost10$thompson_PC1<3,]
abcd.data.almost12<-abcd.data.almost11[abcd.data.almost11$thompson_PC1>-3,]

abcd.data.almost13<-abcd.data.almost12[abcd.data.almost12$thompson_PC2<3,]
abcd.data.almost14<-abcd.data.almost13[abcd.data.almost13$thompson_PC2>-3,]

abcd.data.almost15<-abcd.data.almost14[abcd.data.almost14$thompson_PC3<3,]
abcd.data.almost16<-abcd.data.almost15[abcd.data.almost15$thompson_PC3>-3,]

# 9,510 (only lose 7 subj)
```



# Load train/test split from UMinn
```{r}
traintest<-read_tsv("/Users/askeller/Documents/Kellernet_PrelimAnalysis/participants.tsv")
traintest.baseline<-traintest[traintest$session_id=="ses-baselineYear1Arm1",c("participant_id","matched_group")]
colnames(traintest.baseline)[1]<-c("subjectkey")
traintest.baseline$subjectkey <- gsub(pattern="sub-NDAR",replacement="NDAR_", traintest.baseline$subjectkey)
traintest.baseline<-traintest.baseline %>% distinct()
abcd.data.traintest <- merge(abcd.data.almost16,traintest.baseline,by="subjectkey")
abcd.data.train <- abcd.data.traintest[abcd.data.traintest$matched_group==1,] # n=4,664
abcd.data.test <- abcd.data.traintest[abcd.data.traintest$matched_group==2,] # 4,596
```


# Make a demographics table
```{r}
library(Gmisc)
demo_table <- abcd.data.traintest %>%
  mutate(matched_group = factor(matched_group, levels = 1:2, labels = c("Discovery", "Replication"))) %>%
#subset(matched_group<3) %>%
  set_column_labels(interview_age = "Age (Months)",
                    sex = "Sex",
                    race.6level = "Race",
                    household.income = "Household Income",
                    reshist_addr1_adi_income = "Neighborhood Income",
                    monitoring = "Caregiver Monitoring",
                    warmth = "Caregiver Warmth",
                    thompson_PC1 = "General Cognition",
                    thompson_PC2 = "Executive Function",
                    thompson_PC3 = "Learning/Memory",
                    high.educ = "Parent Education") %>%
getDescriptionStatsBy(interview_age, 
                        sex,
                        thompson_PC1,
                        thompson_PC2,
                        thompson_PC3,
                        monitoring,
                        warmth,
                        reshist_addr1_adi_income,
                        household.income,
                        race.6level,
                        high.educ,
                        add_total_col = TRUE, statistics=TRUE,
                        by = matched_group)

demo_table
```


## How do caregiving behaviors relate to cognition?
### Monitoring is positively related to all 3 cognitive variables but warmth is not
```{r}
cor.test(abcd.data.train$warmth,abcd.data.train$monitoring) # they are correlated at r=0.365

summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.train))
summary(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.train)) # NO LONGER SIGNIFICANT
summary(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.train))

summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth,data=abcd.data.train))
summary(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth,data=abcd.data.train))
summary(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth,data=abcd.data.train))

summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+monitoring,data=abcd.data.train))
summary(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+monitoring,data=abcd.data.train)) # NO LONGER SIGNIFICANT
summary(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+monitoring,data=abcd.data.train))

# Get effect sizes
model1<-anova(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.train))
eta2_w <- F_to_eta2(model1[3,]$`F value`,model1[3,]$NumDF,model1[3,]$DenDF)
eta2_m <- F_to_eta2(model1[4,]$`F value`,model1[4,]$NumDF,model1[4,]$DenDF)
model1<-anova(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.train))
eta2_w <- F_to_eta2(model1[3,]$`F value`,model1[3,]$NumDF,model1[3,]$DenDF)
eta2_m <- F_to_eta2(model1[4,]$`F value`,model1[4,]$NumDF,model1[4,]$DenDF)
model1<-anova(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.train))
eta2_w <- F_to_eta2(model1[3,]$`F value`,model1[3,]$NumDF,model1[3,]$DenDF)
eta2_m <- F_to_eta2(model1[4,]$`F value`,model1[4,]$NumDF,model1[4,]$DenDF)

model1<-anova(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth,data=abcd.data.train))
eta2 <- F_to_eta2(model1[3,]$`F value`,model1[3,]$NumDF,model1[3,]$DenDF)
model1<-anova(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth,data=abcd.data.train))
eta2 <- F_to_eta2(model1[3,]$`F value`,model1[3,]$NumDF,model1[3,]$DenDF)
model1<-anova(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth,data=abcd.data.train))
eta2 <- F_to_eta2(model1[3,]$`F value`,model1[3,]$NumDF,model1[3,]$DenDF)

model1<-anova(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+monitoring,data=abcd.data.train))
eta2 <- F_to_eta2(model1[3,]$`F value`,model1[3,]$NumDF,model1[3,]$DenDF)
model1<-anova(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+monitoring,data=abcd.data.train))
eta2 <- F_to_eta2(model1[3,]$`F value`,model1[3,]$NumDF,model1[3,]$DenDF)
model1<-anova(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+monitoring,data=abcd.data.train))
eta2 <- F_to_eta2(model1[3,]$`F value`,model1[3,]$NumDF,model1[3,]$DenDF)


# Print models to table
mod1<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.train)
mod2<-lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.train)
mod3<-lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.train)
mod4<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth,data=abcd.data.train)
mod5<-lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth,data=abcd.data.train)
mod6<-lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth,data=abcd.data.train)
mod7<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+monitoring,data=abcd.data.train)
mod8<-lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+monitoring,data=abcd.data.train)
mod9<-lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+monitoring,data=abcd.data.train)
tab_model(mod1,mod2,mod3,pred.labels = c("Intercept","Age","Sex","Household Income [50K-100K]","Household Income [>100K]","Neighborhood Income","Parent Educ: HS Diploma/GED","Parent Educ: Some College","Parent Educ: Bachelor","Parent Educ: Post Graduate","Caregiver Warmth","Caregiver Monitoring"),dv.labels=c("General Cognition","Executive Function","Learning/Memory"),digits=2,digits.p=2,show.se=TRUE,show.stat=TRUE,string.stat = "t",string.se = "Std. Error",show.intercept=TRUE,show.ci = FALSE, p.adjust="bonferroni",p.style="scientific",file = "/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Warmth_Monitoring_TableX.doc")
tab_model(mod4,mod5,mod6,pred.labels = c("Intercept","Age","Sex","Household Income [50K-100K]","Household Income [>100K]","Neighborhood Income","Parent Educ: HS Diploma/GED","Parent Educ: Some College","Parent Educ: Bachelor","Parent Educ: Post Graduate","Caregiver Warmth"),dv.labels=c("General Cognition","Executive Function","Learning/Memory"),digits=2,digits.p=2,show.se=TRUE,show.stat=TRUE,string.stat = "t",string.se = "Std. Error",show.intercept=TRUE,show.ci = FALSE, p.adjust="bonferroni",p.style="scientific", file = "/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Warmth_TableX.doc")
tab_model(mod7,mod8,mod9,pred.labels = c("Intercept","Age","Sex","Household Income [50K-100K]","Household Income [>100K]","Neighborhood Income","Parent Educ: HS Diploma/GED","Parent Educ: Some College","Parent Educ: Bachelor","Parent Educ: Post Graduate","Caregiver Monitoring"),dv.labels=c("General Cognition","Executive Function","Learning/Memory"),digits=2,digits.p=2,show.se=TRUE,show.stat=TRUE,string.stat = "t",string.se = "Std. Error",show.intercept=TRUE,show.ci = FALSE, p.adjust="bonferroni",p.style="scientific", file = "/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Monitoring_TableX.doc")
```


## How does SES relate to cognition?
### It's significantly associated with all cognitive variables 
```{r}
summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.train))
summary(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.train))
summary(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.train))

# Get effect sizes
model1<-anova(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.train))
eta2 <- F_to_eta2(model1[3,]$`F value`,model1[3,]$NumDF,model1[3,]$DenDF)
model1<-anova(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.train))
eta2 <- F_to_eta2(model1[3,]$`F value`,model1[3,]$NumDF,model1[3,]$DenDF)
model1<-anova(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.train))
eta2 <- F_to_eta2(model1[3,]$`F value`,model1[3,]$NumDF,model1[3,]$DenDF)

# print results to table
mod10<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.train)
mod11<-lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.train)
mod12<-lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.train)
#tab_model(mod10,mod11,mod12,pred.labels = c("Intercept","Age","Sex","Neighborhood Income","Parent Educ: HS Diploma/GED","Parent Educ: Some College","Parent Educ: Bachelor","Parent Educ: Post Graduate","Household Income [50K-100K]","Household Income [>100K]",),dv.labels=c("General Cognition","Executive Function","Learning/Memory"),digits=2,digits.p=2,show.se=TRUE,show.stat=TRUE,string.stat = "t",string.se = "Std. Error",show.intercept=TRUE,show.ci = FALSE, p.adjust="bonferroni",p.style="scientific",file = "/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Income_TableX.doc")

```



# test whether any of the socio-economic variables are related to BOTH cognition AND monitoring in BOTH discovery/rep samples
```{r}
mod41<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ,data=abcd.data.train)
mod42<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ,data=abcd.data.test)
mod43<-lmer(monitoring~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ,data=abcd.data.train)
mod44<-lmer(monitoring~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ,data=abcd.data.test)

tab_model(mod41,mod42,mod43,mod44,pred.labels = c("Intercept","Age","Sex","Household Income [50K-100K]","Household Income [>100K]","Neighborhood Income","Parent Educ: HS Diploma/GED","Parent Educ: Some College","Parent Educ: Bachelor","Parent Educ: Post Graduate"),dv.labels=c("Cog Train","Cog Test","Mon Train","Mon Test"),digits=2,digits.p=2,show.se=TRUE,show.stat=TRUE,string.stat = "t",string.se = "Std. Error",show.intercept=TRUE,show.ci = FALSE, p.adjust="bonferroni",p.style="scientific", file = "/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/SES_threeVars_allModels.doc")
```



## Is SES associated with differences in parenting behaviors?
### SES is related to differences in monitoring but NOT differences in warmth (doesn't pass correction)
```{r}
summary(lmer(monitoring~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.train))
summary(lmer(warmth~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.train))

# Get effect sizes
model1<-anova(lmer(monitoring~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.train))
eta2 <- F_to_eta2(model1[3,]$`F value`,model1[3,]$NumDF,model1[3,]$DenDF)
model1<-anova(lmer(warmth~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.train))
eta2 <- F_to_eta2(model1[3,]$`F value`,model1[3,]$NumDF,model1[3,]$DenDF)

mod13<-lmer(monitoring~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.train)

tab_model(mod10,mod13,pred.labels = c("Intercept","Age","Sex","Neighborhood Income","Parent Educ: HS Diploma/GED","Parent Educ: Some College","Parent Educ: Bachelor","Parent Educ: Post Graduate","Household Income [50K-100K]","Household Income [>=100K]"),dv.labels=c("General Cognition","Caregiver Monitoring"),digits=2,digits.p=2,show.se=TRUE,show.stat=TRUE,string.stat = "t",string.se = "Std. Error",show.intercept=TRUE,show.ci = FALSE, p.adjust="bonferroni",p.style="scientific",file = "/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Income_GenCog_Monitoring.doc")




# tab_model(mod13,mod14,pred.labels = c("Intercept","Age","Sex","Household Income [50K-100K]","Household Income [>=100K]"),dv.labels=c("Monitoring","Warmth"),digits=2,digits.p=2,show.se=TRUE,show.stat=TRUE,string.stat = "t",string.se = "Std. Error",show.intercept=TRUE,show.ci = FALSE, p.adjust="bonferroni",p.style="scientific",file = "/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Income_Caregiving_TableX.doc")

```


## Look at mediation SES --> monitoring --> PC1
```{r}
#abcd.data.train$simple.income <- relevel(as.factor(ifelse(abcd.data.train$household.income=="[<50K]","Low","High")),"Low")
abcd.data.train$simple.income2 <- relevel(as.factor(ifelse(abcd.data.train$household.income=="[>=100K]","High","Low")),"Low")

summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income2,data=abcd.data.train))
summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income2+monitoring,data=abcd.data.train))


abcd.data.test$simple.income2 <- relevel(as.factor(ifelse(abcd.data.test$household.income=="[>=100K]","High","Low")),"Low")
summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income2,data=abcd.data.test))
summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income2+monitoring,data=abcd.data.test))


summary(lmer(monitoring~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income2,data=abcd.data.train))
summary(lmer(monitoring~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income2,data=abcd.data.test))


summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+monitoring,data=abcd.data.train))
summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+monitoring,data=abcd.data.test))



bs_indir = c()
for (i in 1:1000){
  thisSample <- sample(c(1:length(abcd.data.train$subjectkey)),length(abcd.data.train$subjectkey),replace=TRUE)
  pathc<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income2,data=abcd.data.train[thisSample,])
  pathcp<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income2+monitoring,data=abcd.data.train[thisSample,])
  indir<-fixef(pathc)[9]-fixef(pathcp)[9]
  bs_indir <- c(bs_indir,indir)
}
t.test(bs_indir,conf.level=0.95)

# data:  bs_indir
# t = 53.831, df = 999, p-value < 2.2e-16
# alternative hypothesis: true mean is not equal to 0
# 95 percent confidence interval:
#  0.004476561 0.004815285
# sample estimates:
#   mean of x 
# 0.004645923


bs_indir_test = c()
for (i in 1:1000){
  thisSample <- sample(c(1:length(abcd.data.test$subjectkey)),length(abcd.data.test$subjectkey),replace=TRUE)
  pathc<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income2,data=abcd.data.test[thisSample,])
  pathcp<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income2+monitoring,data=abcd.data.test[thisSample,])
  indir<-fixef(pathc)[9]-fixef(pathcp)[9]
  bs_indir_test <- c(bs_indir_test,indir)
}
t.test(bs_indir_test,conf.level=0.95)

# data:  bs_indir_test
# t = 65.514, df = 999, p-value < 2.2e-16
# alternative hypothesis: true mean is not equal to 0
# 95 percent confidence interval:
#  0.006248254 0.006634122
# sample estimates:
#   mean of x 
# 0.006441188 
```


## Look at mediation SES --> monitoring --> PC2
```{r}
# #abcd.data.train$simple.income <- relevel(as.factor(ifelse(abcd.data.train$household.income=="[<50K]","Low","High")),"Low")
# abcd.data.train$simple.income2 <- relevel(as.factor(ifelse(abcd.data.train$household.income=="[>=100K]","High","Low")),"Low")
# 
# summary(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income2,data=abcd.data.train))
# summary(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income2+monitoring,data=abcd.data.train))
# 
# 
# bs_indir = c()
# for (i in 1:1000){
#   thisSample <- sample(c(1:length(abcd.data.train$subjectkey)),length(abcd.data.train$subjectkey),replace=TRUE)
#   pathc<-lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income2,data=abcd.data.train[thisSample,])
#   pathcp<-lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income2+monitoring,data=abcd.data.train[thisSample,])
#   indir<-fixef(pathc)[9]-fixef(pathcp)[9]
#   bs_indir <- c(bs_indir,indir)
# }
# t.test(bs_indir,conf.level=0.95)
# 
# 

```



## Look at mediation SES --> monitoring --> PC3
```{r}
# #abcd.data.train$simple.income <- relevel(as.factor(ifelse(abcd.data.train$household.income=="[<50K]","Low","High")),"Low")
# abcd.data.train$simple.income2 <- relevel(as.factor(ifelse(abcd.data.train$household.income=="[>=100K]","High","Low")),"Low")
# 
# summary(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income2,data=abcd.data.train))
# summary(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income2+monitoring,data=abcd.data.train))
# 
# 
# bs_indir = c()
# for (i in 1:1000){
#   thisSample <- sample(c(1:length(abcd.data.train$subjectkey)),length(abcd.data.train$subjectkey),replace=TRUE)
#   pathc<-lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income2,data=abcd.data.train[thisSample,])
#   pathcp<-lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income2+monitoring,data=abcd.data.train[thisSample,])
#   indir<-fixef(pathc)[9]-fixef(pathcp)[9]
#   bs_indir <- c(bs_indir,indir)
# }
# t.test(bs_indir,conf.level=0.95)
# 
# 

```


# Make mediation table: # NOTE: NEED TO REDO THESE WITH THE NEW VARIABLES AND COVARIATES - MAKE SURE TO CHANGE THE COEFFICIENT NUMBERS
```{r}
moda<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.train)
modb<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income+monitoring,data=abcd.data.train)
modc<-lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.train)
modd<-lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income+monitoring,data=abcd.data.train)
mode<-lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.train)
modf<-lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income+monitoring,data=abcd.data.train)

tab_model(moda,modc,mode,pred.labels = c("Intercept","Age","Sex","Household Income [50K-100K]","Household Income [>=100K]"),dv.labels=c("General Cognition","Executive Function","Learning/Memory"),digits=2,digits.p=2,show.se=TRUE,show.stat=TRUE,string.stat = "t",string.se = "Std. Error",show.intercept=TRUE,show.ci = FALSE, p.adjust="bonferroni",p.style="scientific",file = "/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Mediation1_TableX.doc")

tab_model(modb,modd,modf,pred.labels = c("Intercept","Age","Sex","Household Income [50K-100K]","Household Income [>=100K]","Monitoring"),dv.labels=c("General Cognition","Executive Function","Learning/Memory"),digits=2,digits.p=2,show.se=TRUE,show.stat=TRUE,string.stat = "t",string.se = "Std. Error",show.intercept=TRUE,show.ci = FALSE, p.adjust="bonferroni",p.style="scientific",file = "/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Mediation2_TableX.doc")
```


# Simplified mediation analyses (>50K vs <50K) for the purpose of the figure
```{r}
# abcd.data.train$simple.income <- ifelse(abcd.data.train$household.income=="[<50K]","Low","High")
# summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income,data=abcd.data.train))
# summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income+monitoring,data=abcd.data.train))
# summary(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income,data=abcd.data.train))
# summary(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income+monitoring,data=abcd.data.train))
# summary(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income,data=abcd.data.train))
# summary(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income+monitoring,data=abcd.data.train))
# 
# 
# abcd.data.train$simple.income2 <- ifelse(abcd.data.train$household.income=="[>=100K]","High","Low")
# summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income2,data=abcd.data.train))
# summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income2+monitoring,data=abcd.data.train))
# summary(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income2,data=abcd.data.train))
# summary(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income2+monitoring,data=abcd.data.train))
# summary(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income2,data=abcd.data.train))
# summary(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income2+monitoring,data=abcd.data.train))
# 
# 
# summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+monitoring,data=abcd.data.train))
# summary(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+monitoring,data=abcd.data.train))
# summary(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+monitoring,data=abcd.data.train))

# summary(lmer(monitoring~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+simple.income,data=abcd.data.train))
```



# Create a correlation matrix showing relatioships among variables
```{r}
important.variables <- abcd.data.traintest[,c("interview_age","reshist_addr1_adi_income","warmth","monitoring","thompson_PC1","thompson_PC2","thompson_PC3")]
colnames(important.variables)<-c("Age","Neighborhood Income","Caregiver Warmth","Caregiver Monitoring","General Cognition","Executive Function","Learning/Memory")
corrplot(cor(important.variables,use="complete.obs"),method=c("number"), tl.col = "black", col=brewer.pal(n=8, name="Spectral"))
```


### Look at specific items within parental warmth and parental monitoring:
```{r}
abcd.data.traintest$crpbi_parent1_y<-as.numeric(abcd.data.traintest$crpbi_parent1_y)
abcd.data.traintest$crpbi_parent2_y<-as.numeric(abcd.data.traintest$crpbi_parent2_y)
abcd.data.traintest$crpbi_parent3_y<-as.numeric(abcd.data.traintest$crpbi_parent3_y)
abcd.data.traintest$crpbi_parent4_y<-as.numeric(abcd.data.traintest$crpbi_parent4_y)
abcd.data.traintest$crpbi_parent5_y<-as.numeric(abcd.data.traintest$crpbi_parent5_y)
abcd.data.traintest$parent_monitor_q1_y<-as.numeric(abcd.data.traintest$parent_monitor_q1_y)
abcd.data.traintest$parent_monitor_q2_y<-as.numeric(abcd.data.traintest$parent_monitor_q2_y)
abcd.data.traintest$parent_monitor_q3_y<-as.numeric(abcd.data.traintest$parent_monitor_q3_y)
abcd.data.traintest$parent_monitor_q4_y<-as.numeric(abcd.data.traintest$parent_monitor_q4_y)
abcd.data.traintest$parent_monitor_q5_y<-as.numeric(abcd.data.traintest$parent_monitor_q5_y)


important.variables3 <- abcd.data.traintest[,c("crpbi_parent1_y","crpbi_parent2_y","crpbi_parent3_y","crpbi_parent4_y","crpbi_parent5_y")]
colnames(important.variables3)<-c("Feel better talking worries","Smiles at me","Feel better when upset","Shows love","Easy to talk to")
corrplot(cor(important.variables3,use="complete.obs"),method=c("number"), tl.col = "black", col=brewer.pal(n=8, name="Spectral"))

important.variables4 <- abcd.data.traintest[,c("parent_monitor_q1_y","parent_monitor_q2_y","parent_monitor_q3_y","parent_monitor_q4_y","parent_monitor_q5_y")]
colnames(important.variables4)<-c("Know where you are","Know who you're with","Know how to contact","Talk over plans","Dinner together")
corrplot(cor(important.variables4,use="complete.obs"),method=c("number"), tl.col = "black", col=brewer.pal(n=8, name="Spectral"))

summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+household.income+high.educ+parent_monitor_q1_y+parent_monitor_q2_y+parent_monitor_q3_y+parent_monitor_q4_y+parent_monitor_q5_y,data=abcd.data.traintest)) # all significant *** (Q4 opp direction)
summary(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+household.income+high.educ+parent_monitor_q1_y+parent_monitor_q2_y+parent_monitor_q3_y+parent_monitor_q4_y+parent_monitor_q5_y,data=abcd.data.traintest)) # only q2 sig
summary(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+household.income+high.educ+parent_monitor_q1_y+parent_monitor_q2_y+parent_monitor_q3_y+parent_monitor_q4_y+parent_monitor_q5_y,data=abcd.data.traintest)) # all but q3 significant (Q4 opp direction)

# summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+crpbi_parent1_y+crpbi_parent2_y+crpbi_parent3_y+crpbi_parent4_y+crpbi_parent5_y,data=abcd.data.traintest)) # Q2, Q4, Q5 significant (Q5 opp direction)
# summary(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+crpbi_parent1_y+crpbi_parent2_y+crpbi_parent3_y+crpbi_parent4_y+crpbi_parent5_y,data=abcd.data.traintest)) # Q2, Q4, Q5 significant (Q5 opp direction)
# summary(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+crpbi_parent1_y+crpbi_parent2_y+crpbi_parent3_y+crpbi_parent4_y+crpbi_parent5_y,data=abcd.data.traintest)) # Q2, Q4, Q5 significant (Q5 opp direction)
# 


# make tables
abcd.data.traintest$simple.income2 <- relevel(as.factor(ifelse(abcd.data.traintest$household.income=="[>=100K]","High","Low")),"Low")

mod15<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+simple.income2+high.educ+parent_monitor_q1_y+parent_monitor_q2_y+parent_monitor_q3_y+parent_monitor_q4_y+parent_monitor_q5_y,data=abcd.data.traintest)
#mod16<-lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+household.income+high.educ+parent_monitor_q1_y+parent_monitor_q2_y+parent_monitor_q3_y+parent_monitor_q4_y+parent_monitor_q5_y,data=abcd.data.traintest)
#mod17<-lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+household.income+high.educ+parent_monitor_q1_y+parent_monitor_q2_y+parent_monitor_q3_y+parent_monitor_q4_y+parent_monitor_q5_y,data=abcd.data.traintest)
tab_model(mod15,pred.labels = c("Intercept","Age","Sex","Neighborhood Income","Household Income (>100K)","HS Diploma/GED","Some College","Bachelor","Post Graduate","Know where you are","Know who you're with","Know how to contact","Talk over plans","Dinner together"),dv.labels=c("General Cognition"),digits=2,digits.p=2,show.se=TRUE,show.stat=TRUE,string.stat = "t",string.se = "Std. Error",show.intercept=TRUE,show.ci = FALSE, p.adjust="bonferroni",p.style="scientific",file = "/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Items_TableX.doc")




mod16<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+household.income+high.educ+parent_monitor_q1_y+parent_monitor_q2_y+parent_monitor_q3_y+parent_monitor_q4_y+parent_monitor_q5_y,data=abcd.data.traintest)
tab_model(mod16,pred.labels = c("Intercept","Age","Sex","Neighborhood Income","Household Income [50K-100K]","Household Income [>100K]","Parent Educ: HS Diploma/GED","Parent Educ: Some College","Parent Educ: Bachelor","Parent Educ: Post Graduate","Q1. Know where you are","Q2. Know who you're with","Q3. Know how to contact","Q4. Talk over plans","Q5. Dinner together"),dv.labels=c("General Cognition"),digits=2,digits.p=2,show.se=TRUE,show.stat=TRUE,string.stat = "t",string.se = "Std. Error",show.intercept=TRUE,show.ci = FALSE,p.style="scientific",file = "/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Items_TableX.doc")



# try the same thing but with the question number coded as a factor to look at an interaction
monitoring_qs <- abcd.data.traintest[,c("subjectkey","parent_monitor_q1_y","parent_monitor_q2_y","parent_monitor_q3_y","parent_monitor_q4_y","parent_monitor_q5_y")]
library("reshape2")
test<-melt(monitoring_qs)
merged.dataset<-merge(test,abcd.data.traintest,by="subjectkey")
merged.dataset$variable=as.factor(merged.dataset$variable)
summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+household.income+high.educ+value*variable,data=merged.dataset))
mod100<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+household.income+high.educ+value*variable,data=merged.dataset)
tab_model(mod100,pred.labels = c("Intercept","Age","Sex","Neighborhood Income","Household Income1","Household Income2","HS Diploma/GED","Some College","Bachelor","Post Graduate","Know where you are","Know who you're with","Know how to contact","Talk over plans","Dinner together"),dv.labels=c("General Cognition"),digits=2,digits.p=2,show.se=TRUE,show.stat=TRUE,string.stat = "t",string.se = "Std. Error",show.intercept=TRUE,show.ci = FALSE, p.adjust="bonferroni",p.style="scientific",file = "/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Items_TableX.doc")


```


### Is parental monitoring related to increased stress exposures?
```{r}
abcd.data.traintest$totalACEs <- rowSums(data.frame(as.numeric(abcd.data.traintest$ksads_ptsd_raw_754_p),as.numeric(abcd.data.traintest$ksads_ptsd_raw_755_p),as.numeric(abcd.data.traintest$ksads_ptsd_raw_756_p),as.numeric(abcd.data.traintest$ksads_ptsd_raw_757_p),as.numeric(abcd.data.traintest$ksads_ptsd_raw_758_p),as.numeric(abcd.data.traintest$ksads_ptsd_raw_759_p),as.numeric(abcd.data.traintest$ksads_ptsd_raw_760_p),as.numeric(abcd.data.traintest$ksads_ptsd_raw_761_p),as.numeric(abcd.data.traintest$ksads_ptsd_raw_762_p),as.numeric(abcd.data.traintest$ksads_ptsd_raw_763_p),as.numeric(abcd.data.traintest$ksads_ptsd_raw_764_p),as.numeric(abcd.data.traintest$ksads_ptsd_raw_765_p),as.numeric(abcd.data.traintest$ksads_ptsd_raw_766_p),as.numeric(abcd.data.traintest$ksads_ptsd_raw_767_p),as.numeric(abcd.data.traintest$ksads_ptsd_raw_768_p),as.numeric(abcd.data.traintest$ksads_ptsd_raw_769_p),as.numeric(abcd.data.traintest$ksads_ptsd_raw_770_p)),na.rm=TRUE)
# 
summary(lmer(totalACEs~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+household.income+high.educ+monitoring,data=abcd.data.traintest))
```


### Sensitivity analyses
```{r}
# # Race 6 level (1: White | 2: Black | 3: Asian | 4: AIAN/NHPI | 5: Other | 6: Mixed)
# summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+race.6level+monitoring,data=abcd.data.train))
# summary(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+race.6level+monitoring,data=abcd.data.train))
# summary(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+race.6level+monitoring,data=abcd.data.train))
# 
# summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+race.6level+household.income,data=abcd.data.train))
# summary(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+race.6level+household.income,data=abcd.data.train))
# summary(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+race.6level+household.income,data=abcd.data.train))
# 
# summary(lmer(monitoring~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+race.6level+household.income,data=abcd.data.train))
# 
# 
# # Parent's highest degree of education
# summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+high.educ+monitoring,data=abcd.data.train))
# summary(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+high.educ+monitoring,data=abcd.data.train))
# summary(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+high.educ+monitoring,data=abcd.data.train))
# 
# summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+high.educ+household.income,data=abcd.data.train))
# summary(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+high.educ+household.income,data=abcd.data.train))
# summary(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+high.educ+household.income,data=abcd.data.train))
# 
# summary(lmer(monitoring~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+high.educ+household.income,data=abcd.data.train))
# 
# # Add some more variables:
# addvar<-readRDS("/Users/askeller/Documents/Kellernet_PrelimAnalysis/DEAP-discrim-marriage.rds")
# addvar.baseline<-addvar[addvar$event_name=="baseline_year_1_arm_1",]
# colnames(addvar.baseline)[1]<-"subjectkey"
# abcd.addvar <- merge(abcd.data.train,addvar.baseline[, c("subjectkey", setdiff(colnames(addvar.baseline),colnames(abcd.data.train)))],by="subjectkey")
# 
# # Parents Married or Living Together
# summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+married.or.livingtogether+monitoring,data=abcd.addvar))
# summary(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+married.or.livingtogether+monitoring,data=abcd.addvar))
# summary(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+married.or.livingtogether+monitoring,data=abcd.addvar))
# 
# summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+married.or.livingtogether+household.income,data=abcd.addvar))
# summary(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+married.or.livingtogether+household.income,data=abcd.addvar))
# summary(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+married.or.livingtogether+household.income,data=abcd.addvar))
# 
# summary(lmer(monitoring~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+married.or.livingtogether+household.income,data=abcd.addvar))
# 
# 
# # print tables for supplement
# mod18<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+race.6level+monitoring,data=abcd.data.train)
# mod19<-lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+race.6level+monitoring,data=abcd.data.train)
# mod20<-lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+race.6level+monitoring,data=abcd.data.train)
# mod21<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+high.educ+monitoring,data=abcd.data.train)
# mod22<-lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+high.educ+monitoring,data=abcd.data.train)
# mod23<-lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+high.educ+monitoring,data=abcd.data.train)
# mod24<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+married.or.livingtogether+monitoring,data=abcd.addvar)
# mod25<-lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+married.or.livingtogether+monitoring,data=abcd.addvar)
# mod26<-lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+married.or.livingtogether+monitoring,data=abcd.addvar)
# tab_model(mod18,mod19,mod20,pred.labels = c("Intercept","Age","Sex","White","Black","Asian","AIAN/NHPI","Other","Mixed","Monitoring"),dv.labels=c("General Cognition","Executive Function","Learning/Memory"),digits=2,digits.p=2,show.se=TRUE,show.stat=TRUE,string.stat = "t",string.se = "Std. Error",show.intercept=TRUE,show.ci = FALSE, p.adjust="bonferroni",p.style="scientific",file = "/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Sens_Race_TableX.doc")
# tab_model(mod21,mod22,mod23,pred.labels = c("Intercept","Age","Sex","HS Diploma/GED","Some College","Bachelor","Post Graduate","Monitoring"),dv.labels=c("General Cognition","Executive Function","Learning/Memory"),digits=2,digits.p=2,show.se=TRUE,show.stat=TRUE,string.stat = "t",string.se = "Std. Error",show.intercept=TRUE,show.ci = FALSE, p.adjust="bonferroni",p.style="scientific",file = "/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Sens_Edu_TableX.doc")
# tab_model(mod24,mod25,mod26,pred.labels = c("Intercept","Age","Sex","Married/Living Together","Monitoring"),dv.labels=c("General Cognition","Executive Function","Learning/Memory"),digits=2,digits.p=2,show.se=TRUE,show.stat=TRUE,string.stat = "t",string.se = "Std. Error",show.intercept=TRUE,show.ci = FALSE, p.adjust="bonferroni",p.style="scientific",file = "/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Sens_Mar_TableX.doc")
```


# Generate Figures
```{r}
# png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/SES_PC1.png",
#     width = 4000, 
#     height = 3000,
#     res=1000)
# ggplot(data=subset(abcd.data.train,!is.na(household.income)),aes(household.income,thompson_PC1))+geom_boxplot(aes(household.income,thompson_PC1),color=rgb(33/255,80/255,113/255))+coord_cartesian(ylim = c(170, 320))+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
# panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('General Cognition') + xlab('Household Income')
# dev.off() 

png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/SES_PC1_violin.png",
    width = 4000, 
    height = 3000,
    res=1000)
ggplot(data=subset(abcd.data.train,!is.na(household.income)),aes(household.income,thompson_PC1))+geom_violin(aes(household.income,thompson_PC1),fill=rgb(33/255,80/255,113/255),trim=FALSE)+geom_boxplot(aes(household.income,thompson_PC1),width=0.2)+coord_cartesian(ylim = c(-3, 3))+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('General Cognition') + xlab('Household Income')
dev.off() 

# png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/SES_PC2.png",
#     width = 4000, 
#     height = 3000,
#     res=1000)
# ggplot(data=subset(abcd.data.train,!is.na(household.income)),aes(household.income,thompson_PC2))+geom_boxplot(aes(household.income,thompson_PC2),color=rgb(64/255,141/255,151/255))+coord_cartesian(ylim = c(170, 320))+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
# panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('Executive Function') + xlab('Household Income')
# dev.off() 

png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/SES_PC2_violin.png",
    width = 4000, 
    height = 3000,
    res=1000)
ggplot(data=subset(abcd.data.train,!is.na(household.income)),aes(household.income,thompson_PC2))+geom_violin(aes(household.income,thompson_PC2),fill=rgb(64/255,141/255,151/255),trim=FALSE)+geom_boxplot(aes(household.income,thompson_PC2),width=0.2)+coord_cartesian(ylim = c(-3, 3))+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('Executive Function') + xlab('Household Income')
dev.off() 

# png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/SES_PC3.png",
#     width = 4000, 
#     height = 3000,
#     res=1000)
# ggplot(data=subset(abcd.data.train,!is.na(household.income)),aes(household.income,thompson_PC3))+geom_boxplot(aes(household.income,thompson_PC3),color=rgb(157/255,207/255,160/255))+coord_cartesian(ylim = c(-3, 3))+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
# panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('Learning/Memory') + xlab('Household Income')
# dev.off() 


png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/SES_PC3_violin.png",
    width = 4000, 
    height = 3000,
    res=1000)
ggplot(data=subset(abcd.data.train,!is.na(household.income)),aes(household.income,thompson_PC3))+geom_violin(aes(household.income,thompson_PC3),fill=rgb(157/255,207/255,160/255),trim=FALSE)+geom_boxplot(aes(household.income,thompson_PC3),width=0.2)+coord_cartesian(ylim = c(-3, 3))+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('Learning/Memory') + xlab('Household Income')
dev.off() 



png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/FigPanels/BiggerTextSize_051522/Monitoring_PC1.png",
    width = 2600, 
    height = 3100,
    res=1200)
ggplot(data=abcd.data.train,aes(monitoring,thompson_PC1))+geom_point(position="jitter",size=0.5,colour=rgb(33/255,80/255,113/255))+geom_smooth(method=lm,colour='black')+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('General Cognition') + xlab('Monitoring (z)') +coord_cartesian(xlim = c(-5.6,1.1), ylim = c(-3, 3))
dev.off() 

png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/FigPanels/BiggerTextSize_051522/Monitoring_PC2.png",
    width = 2600, 
    height = 3100,
    res=1200)
ggplot(data=abcd.data.train,aes(monitoring,thompson_PC2))+geom_point(position="jitter",size=0.5,colour=rgb(64/255,141/255,151/255))+geom_smooth(method=lm,colour='black')+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('Executive Function') + xlab('Monitoring (z)') +coord_cartesian(xlim = c(-5.6,1.1), ylim = c(-3, 3))
dev.off() 

png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/FigPanels/BiggerTextSize_051522/Monitoring_PC3.png",
    width = 2600, 
    height = 3100,
    res=1200)
ggplot(data=abcd.data.train,aes(monitoring,thompson_PC3))+geom_point(position="jitter",size=0.5,colour=rgb(157/255,207/255,160/255))+geom_smooth(method=lm,colour='black')+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('Learning/Memory') + xlab('Monitoring (z)') +coord_cartesian(xlim = c(-5.6,1.1), ylim = c(-2.5, 2.5))
dev.off() 



png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/FigPanels/BiggerTextSize_051522/Warmth_PC1.png",
    width = 2600, 
    height = 3100,
    res=1200)
ggplot(data=abcd.data.train,aes(warmth,thompson_PC1))+geom_point(position="jitter",size=0.5,colour=rgb(33/255,80/255,113/255))+geom_smooth(method=lm,colour='black')+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('General Cognition') + xlab('Warmth (z)') +coord_cartesian(xlim = c(-5.6,1.1), ylim = c(-3, 3))
dev.off() 

png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/FigPanels/BiggerTextSize_051522/Warmth_PC2.png",
    width = 2600, 
    height = 3100,
    res=1200)
ggplot(data=abcd.data.train,aes(warmth,thompson_PC2))+geom_point(position="jitter",size=0.5,colour=rgb(64/255,141/255,151/255))+geom_smooth(method=lm,colour='black')+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('Executive Function') + xlab('Warmth (z)') +coord_cartesian(xlim = c(-5.6,1.1), ylim = c(-3, 3))
dev.off() 

png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/FigPanels/BiggerTextSize_051522/Warmth_PC3.png",
    width = 2600, 
    height = 3100,
    res=1200)
ggplot(data=abcd.data.train,aes(warmth,thompson_PC3))+geom_point(position="jitter",size=0.5,colour=rgb(157/255,207/255,160/255))+geom_smooth(method=lm,colour='black')+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('Learning/Memory') + xlab('Warmth (z)') +coord_cartesian(xlim = c(-5.6,1.1), ylim = c(-2.5, 2.5))
dev.off() 






df.summary <- subset(abcd.data.train,!is.na(household.income)) %>%
     group_by(household.income) %>%
     summarise(
         se = sd(warmth, na.rm = TRUE)/sqrt(length(warmth)),
         warmth = mean(warmth,na.rm=TRUE))
png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Warmth_SES.png",
    width = 4000, 
    height = 2000,
    res=700)
ggplot(data=df.summary,aes(household.income,warmth,fill=as.factor(household.income)))+geom_bar(position = "dodge",stat = "identity")+coord_cartesian(ylim = c(-0.25, 0.25))+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('Warmth (z)') + xlab('Household Income') + scale_fill_manual(values = c(rgb(145/255,69/255,93/255),rgb(206/255,118/255,119/255),rgb(227/255,180/255,150/255))) + geom_errorbar(aes(ymin=warmth-se, ymax=warmth+se), width=.2,position=position_dodge(.9))
dev.off() 

df.summary <- subset(abcd.data.train,!is.na(household.income)) %>%
     group_by(household.income) %>%
     summarise(
         se = sd(monitoring, na.rm = TRUE)/sqrt(length(monitoring)),
         monitoring = mean(monitoring,na.rm=TRUE))
png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Monitoring_SES.png",
    width = 4000, 
    height = 2000,
    res=700)
ggplot(data=df.summary,aes(household.income,monitoring,fill=as.factor(household.income)))+geom_bar(position = "dodge",stat = "identity")+coord_cartesian(ylim = c(-0.25, 0.25))+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('Monitoring (z)') + xlab('Household Income') + scale_fill_manual(values = c(rgb(145/255,69/255,93/255),rgb(206/255,118/255,119/255),rgb(227/255,180/255,150/255))) + geom_errorbar(aes(ymin=monitoring-se, ymax=monitoring+se), width=.2,position=position_dodge(.9))
dev.off() 


save_train_data<-data.frame(abcd.data.train$thompson_PC1,abcd.data.train$thompson_PC2,abcd.data.train$thompson_PC3,abcd.data.train$warmth,abcd.data.train$monitoring)
save_test_data<-data.frame(abcd.data.test$thompson_PC1,abcd.data.test$thompson_PC2,abcd.data.test$thompson_PC3,abcd.data.test$warmth,abcd.data.test$monitoring)
write.csv(save_train_data,"/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/traintest_figs/data_from_R_train.csv")
write.csv(save_test_data,"/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/traintest_figs/data_from_R_test.csv")



```



# Generalizability!
```{r}
mod31<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+household.income+high.educ+warmth,data=abcd.data.test)
mod32<-lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+household.income+high.educ+warmth,data=abcd.data.test)
mod33<-lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+household.income+high.educ+warmth,data=abcd.data.test)

tab_model(mod31,mod32,mod33,digits=3,digits.p=3,show.se=TRUE,show.stat=TRUE,string.stat = "t",string.se = "Std. Error",show.intercept=TRUE,show.ci = FALSE, p.adjust="bonferroni",p.style="scientific")

mod34<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+household.income+high.educ+monitoring,data=abcd.data.test)
mod35<-lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+household.income+high.educ+monitoring,data=abcd.data.test)
mod36<-lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+household.income+high.educ+monitoring,data=abcd.data.test)

tab_model(mod34,mod35,mod36,digits=3,digits.p=3,show.se=TRUE,show.stat=TRUE,string.stat = "t",string.se = "Std. Error",show.intercept=TRUE,show.ci = FALSE, p.adjust="bonferroni",p.style="scientific")

summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.test))
summary(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.test))
summary(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.test))


summary(lmer(monitoring~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.test))
summary(lmer(warmth~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.test))





mod54<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+household.income+high.educ+warmth+monitoring,data=abcd.data.test)
mod55<-lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+household.income+high.educ+warmth+monitoring,data=abcd.data.test)
mod56<-lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+household.income+high.educ+warmth+monitoring,data=abcd.data.test)

tab_model(mod54,mod55,mod56,digits=3,digits.p=3,show.se=TRUE,show.stat=TRUE,string.stat = "t",string.se = "Std. Error",show.intercept=TRUE,show.ci = FALSE, p.adjust="bonferroni",p.style="scientific")



# summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.test))
# summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income+monitoring,data=abcd.data.test))
# 
# # NEED TO REDO THIS WITH NEW MODELS!!!
# bs_indir = c()
# for (i in 1:1000){
#   thisSample <- sample(c(1:length(abcd.data.test$subjectkey)),length(abcd.data.test$subjectkey),replace=TRUE)
#   pathc<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.test[thisSample,])
#   pathcp<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income+monitoring,data=abcd.data.test[thisSample,])
#   indir<-fixef(pathc)[5]-fixef(pathcp)[5]
#   bs_indir <- c(bs_indir,indir)
# }
# t.test(bs_indir,conf.level=0.95)




# summary(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.test))
# summary(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income+monitoring,data=abcd.data.test))
# 
# # NEED TO REDO THIS WITH NEW MODELS!!!
# bs_indir = c()
# for (i in 1:1000){
#   thisSample <- sample(c(1:length(abcd.data.test$subjectkey)),length(abcd.data.test$subjectkey),replace=TRUE)
#   pathc<-lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.test[thisSample,])
#   pathcp<-lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income+monitoring,data=abcd.data.test[thisSample,])
#   indir<-fixef(pathc)[5]-fixef(pathcp)[5]
#   bs_indir <- c(bs_indir,indir)
# }
# t.test(bs_indir,conf.level=0.95)



# 
# summary(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.test))
# summary(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income+monitoring,data=abcd.data.test))
# 
# # NEED TO REDO THIS WITH NEW MODELS!!!
# bs_indir = c()
# for (i in 1:1000){
#   thisSample <- sample(c(1:length(abcd.data.test$subjectkey)),length(abcd.data.test$subjectkey),replace=TRUE)
#   pathc<-lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.test[thisSample,])
#   pathcp<-lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income+monitoring,data=abcd.data.test[thisSample,])
#   indir<-fixef(pathc)[5]-fixef(pathcp)[5]
#   bs_indir <- c(bs_indir,indir)
# }
# t.test(bs_indir,conf.level=0.95)
```




# Generate Figures - TEST DATA
```{r}
png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/SES_PC1_violin_test.png",
    width = 4000, 
    height = 3000,
    res=1000)
ggplot(data=subset(abcd.data.test,!is.na(household.income)),aes(household.income,thompson_PC1))+geom_violin(aes(household.income,thompson_PC1),fill=rgb(33/255,80/255,113/255),trim=FALSE)+geom_boxplot(aes(household.income,thompson_PC1),width=0.2)+coord_cartesian(ylim = c(-3, 3))+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('General Cognition') + xlab('Household Income')
dev.off() 


png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/SES_PC2_violin_test.png",
    width = 4000, 
    height = 3000,
    res=1000)
ggplot(data=subset(abcd.data.test,!is.na(household.income)),aes(household.income,thompson_PC2))+geom_violin(aes(household.income,thompson_PC2),fill=rgb(64/255,141/255,151/255),trim=FALSE)+geom_boxplot(aes(household.income,thompson_PC2),width=0.2)+coord_cartesian(ylim = c(-3, 3))+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('Executive Function') + xlab('Household Income')
dev.off() 


png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/SES_PC3_violin_test.png",
    width = 4000, 
    height = 3000,
    res=1000)
ggplot(data=subset(abcd.data.test,!is.na(household.income)),aes(household.income,thompson_PC3))+geom_violin(aes(household.income,thompson_PC3),fill=rgb(157/255,207/255,160/255),trim=FALSE)+geom_boxplot(aes(household.income,thompson_PC3),width=0.2)+coord_cartesian(ylim = c(-3, 3))+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('Learning/Memory') + xlab('Household Income')
dev.off() 



png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/FigPanels/BiggerTextSize_051522/Monitoring_PC1_test.png",
    width = 2600, 
    height = 3100,
    res=1200)
ggplot(data=abcd.data.test,aes(monitoring,thompson_PC1))+geom_point(position="jitter",size=0.5,colour=rgb(33/255,80/255,113/255))+geom_smooth(method=lm,colour='black')+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('General Cognition') + xlab('Monitoring (z)') +coord_cartesian(xlim = c(-6.5,1.1), ylim = c(-3, 3))
dev.off() 

png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/FigPanels/BiggerTextSize_051522/Monitoring_PC2_test.png",
    width = 2600, 
    height = 3100,
    res=1200)
ggplot(data=abcd.data.test,aes(monitoring,thompson_PC2))+geom_point(position="jitter",size=0.5,colour=rgb(64/255,141/255,151/255))+geom_smooth(method=lm,colour='black')+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('Executive Function') + xlab('Monitoring (z)') +coord_cartesian(xlim = c(-6.5,1.1), ylim = c(-3, 3))
dev.off() 

png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/FigPanels/BiggerTextSize_051522/Monitoring_PC3_test.png",
    width = 2600, 
    height = 3100,
    res=1200)
ggplot(data=abcd.data.test,aes(monitoring,thompson_PC3))+geom_point(position="jitter",size=0.5,colour=rgb(157/255,207/255,160/255))+geom_smooth(method=lm,colour='black')+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('Learning/Memory') + xlab('Monitoring (z)') +coord_cartesian(xlim = c(-6.5,1.1), ylim = c(-2.5, 2.5))
dev.off() 



png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/FigPanels/BiggerTextSize_051522/Warmth_PC1_test.png",
    width = 2600, 
    height = 3100,
    res=1200)
ggplot(data=abcd.data.test,aes(warmth,thompson_PC1))+geom_point(position="jitter",size=0.5,colour=rgb(33/255,80/255,113/255))+geom_smooth(method=lm,colour='black')+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('General Cognition') + xlab('Warmth (z)') +coord_cartesian(xlim = c(-6.5,1.1), ylim = c(-3, 3))
dev.off() 

png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/FigPanels/BiggerTextSize_051522/Warmth_PC2_test.png",
    width = 2600, 
    height = 3100,
    res=1200)
ggplot(data=abcd.data.test,aes(warmth,thompson_PC2))+geom_point(position="jitter",size=0.5,colour=rgb(64/255,141/255,151/255))+geom_smooth(method=lm,colour='black')+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('Executive Function') + xlab('Warmth (z)') +coord_cartesian(xlim = c(-6.5,1.1), ylim = c(-3, 3))
dev.off() 

png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/FigPanels/BiggerTextSize_051522/Warmth_PC3_test.png",
    width = 2600, 
    height = 3100,
    res=1200)
ggplot(data=abcd.data.test,aes(warmth,thompson_PC3))+geom_point(position="jitter",size=0.5,colour=rgb(157/255,207/255,160/255))+geom_smooth(method=lm,colour='black')+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('Learning/Memory') + xlab('Warmth (z)') +coord_cartesian(xlim = c(-6.5,1.1), ylim = c(-2.5, 2.5))
dev.off() 






df.summary <- subset(abcd.data.test,!is.na(household.income)) %>%
     group_by(household.income) %>%
     summarise(
         se = sd(warmth, na.rm = TRUE)/sqrt(length(warmth)),
         warmth = mean(warmth,na.rm=TRUE))
png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Warmth_SES_test.png",
    width = 4000, 
    height = 2000,
    res=700)
ggplot(data=df.summary,aes(household.income,warmth,fill=as.factor(household.income)))+geom_bar(position = "dodge",stat = "identity")+coord_cartesian(ylim = c(-0.25, 0.25))+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('Warmth (z)') + xlab('Household Income') + scale_fill_manual(values = c(rgb(145/255,69/255,93/255),rgb(206/255,118/255,119/255),rgb(227/255,180/255,150/255))) + geom_errorbar(aes(ymin=warmth-se, ymax=warmth+se), width=.2,position=position_dodge(.9))
dev.off() 

df.summary <- subset(abcd.data.test,!is.na(household.income)) %>%
     group_by(household.income) %>%
     summarise(
         se = sd(monitoring, na.rm = TRUE)/sqrt(length(monitoring)),
         monitoring = mean(monitoring,na.rm=TRUE))
png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Monitoring_SES_test.png",
    width = 4000, 
    height = 2000,
    res=700)
ggplot(data=df.summary,aes(household.income,monitoring,fill=as.factor(household.income)))+geom_bar(position = "dodge",stat = "identity")+coord_cartesian(ylim = c(-0.25, 0.25))+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('Monitoring (z)') + xlab('Household Income') + scale_fill_manual(values = c(rgb(145/255,69/255,93/255),rgb(206/255,118/255,119/255),rgb(227/255,180/255,150/255))) + geom_errorbar(aes(ymin=monitoring-se, ymax=monitoring+se), width=.2,position=position_dodge(.9))
dev.off() 
```



# exploration of some potential explanations for the effect of income-->monitoring
```{r}
siblings_jobs <- readRDS("/Users/askeller/Documents/Kellernet_PrelimAnalysis/DEAP-sibs-jobs2.rds")
siblings_jobs.baseline<-siblings_jobs[siblings_jobs$event_name=="baseline_year_1_arm_1",]
colnames(siblings_jobs.baseline)[1]<-"subjectkey"

siblings_jobs.baseline$both_caregivers_fulltime <- ifelse((siblings_jobs.baseline$demo_prnt_empl_time_p=="Full time" & siblings_jobs.baseline$demo_prtnr_empl_time_p=="Full time"),1,0)

siblings_jobs.baseline$have_stay_at_home_parent <- ifelse((siblings_jobs.baseline$demo_prnt_empl_p=="Stay at Home Parent" | siblings_jobs.baseline$demo_prtnr_empl_p=="Stay at Home Parent"),1,0)

siblings_jobs.baseline$num_sibs <- 

abcd.data.train2 <- merge(abcd.data.train,siblings_jobs.baseline[,c("subjectkey", setdiff(colnames(siblings_jobs.baseline),colnames(abcd.data.train)))],by="subjectkey")
abcd.data.test2 <- merge(abcd.data.test,siblings_jobs.baseline[,c("subjectkey", setdiff(colnames(siblings_jobs.baseline),colnames(abcd.data.test)))],by="subjectkey")
abcd.data.traintest2 <- merge(abcd.data.traintest,siblings_jobs.baseline[,c("subjectkey", setdiff(colnames(siblings_jobs.baseline),colnames(abcd.data.traintest)))],by="subjectkey")



summary(lmer(monitoring~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income+both_caregivers_fulltime,data=abcd.data.traintest2))
summary(lmer(monitoring~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+both_caregivers_fulltime,data=abcd.data.traintest2))

summary(lmer(monitoring~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+both_caregivers_fulltime,data=abcd.data.traintest2))


summary(lmer(both_caregivers_fulltime~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income,data=abcd.data.traintest2))

summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+household.income+both_caregivers_fulltime,data=abcd.data.traintest2))

summary(lmer(monitoring~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+both_caregivers_fulltime,data=abcd.data.traintest2))
summary(lmer(monitoring~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+have_stay_at_home_parent,data=abcd.data.traintest2))

summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+monitoring,data=abcd.data.train2))
summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+high.educ+have_stay_at_home_parent*monitoring,data=abcd.data.train2))

#sibs <- readRDS("/Users/askeller/Documents/Kellernet_PrelimAnalysis/DEAP-brosis.rds")

```



# What about abuse?
```{r}
# Compute a ksads "abuse" variable" and a total score
# These are the items that will go into this score (they're the physical and sexual abuse variables)
# 761, 762, 763, 767, 768, 769
abcd.data.train$abuse <- rowSums(data.frame(as.numeric(abcd.data.train$ksads_ptsd_raw_761_p),as.numeric(abcd.data.train$ksads_ptsd_raw_762_p),as.numeric(abcd.data.train$ksads_ptsd_raw_763_p),as.numeric(abcd.data.train$ksads_ptsd_raw_767_p),as.numeric(abcd.data.train$ksads_ptsd_raw_768_p),as.numeric(abcd.data.train$ksads_ptsd_raw_769_p)),na.rm=TRUE)

abcd.data.test$abuse <- rowSums(data.frame(as.numeric(abcd.data.test$ksads_ptsd_raw_761_p),as.numeric(abcd.data.test$ksads_ptsd_raw_762_p),as.numeric(abcd.data.test$ksads_ptsd_raw_763_p),as.numeric(abcd.data.test$ksads_ptsd_raw_767_p),as.numeric(abcd.data.test$ksads_ptsd_raw_768_p),as.numeric(abcd.data.test$ksads_ptsd_raw_769_p)),na.rm=TRUE)

abcd.data.train$abuse_binary <- ifelse(abcd.data.train$abuse>0,1,0)
abcd.data.test$abuse_binary <- ifelse(abcd.data.test$abuse>0,1,0)

summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+abuse_binary,data=abcd.data.train))
summary(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+abuse_binary,data=abcd.data.train))
summary(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+abuse_binary,data=abcd.data.train))


summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+abuse_binary,data=abcd.data.test))
summary(lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+abuse_binary,data=abcd.data.test))
summary(lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+abuse_binary,data=abcd.data.test))




# df.summary <- subset(abcd.data.train,!is.na(abuse_binary)) %>%
#      group_by(abuse_binary) %>%
#      summarise(
#          se = sd(thompson_PC1, na.rm = TRUE)/sqrt(length(thompson_PC1)),
#          thompson_PC1 = mean(thompson_PC1,na.rm=TRUE))
# png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Abuse_PC1_train.png",
#     width = 4000, 
#     height = 2000,
#     res=700)
# ggplot(data=df.summary,aes(abuse_binary,thompson_PC1,fill=as.factor(abuse_binary)))+geom_bar(position = "dodge",stat = "identity")+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('General Cognition') + xlab('Abuse') + scale_fill_manual(values = c(rgb(145/255,69/255,93/255),rgb(206/255,118/255,119/255),rgb(227/255,180/255,150/255))) + geom_errorbar(aes(ymin=thompson_PC1-se, ymax=thompson_PC1+se), width=.2,position=position_dodge(.9))
# dev.off() 
# #+coord_cartesian(ylim = c(-0.25, 0.25))
# 
# 
# df.summary <- subset(abcd.data.train,!is.na(abuse_binary)) %>%
#      group_by(abuse_binary) %>%
#      summarise(
#          se = sd(thompson_PC2, na.rm = TRUE)/sqrt(length(thompson_PC2)),
#          thompson_PC2 = mean(thompson_PC2,na.rm=TRUE))
# png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Abuse_PC2_train.png",
#     width = 4000, 
#     height = 2000,
#     res=700)
# ggplot(data=df.summary,aes(abuse_binary,thompson_PC2,fill=as.factor(abuse_binary)))+geom_bar(position = "dodge",stat = "identity")+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('Executive Function') + xlab('Abuse') + scale_fill_manual(values = c(rgb(145/255,69/255,93/255),rgb(206/255,118/255,119/255),rgb(227/255,180/255,150/255))) + geom_errorbar(aes(ymin=thompson_PC2-se, ymax=thompson_PC2+se), width=.2,position=position_dodge(.9))
# dev.off() 
# 
# 
# df.summary <- subset(abcd.data.train,!is.na(abuse_binary)) %>%
#      group_by(abuse_binary) %>%
#      summarise(
#          se = sd(thompson_PC3, na.rm = TRUE)/sqrt(length(thompson_PC3)),
#          thompson_PC3 = mean(thompson_PC3,na.rm=TRUE))
# png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Abuse_PC3_train.png",
#     width = 4000, 
#     height = 2000,
#     res=700)
# ggplot(data=df.summary,aes(abuse_binary,thompson_PC3,fill=as.factor(abuse_binary)))+geom_bar(position = "dodge",stat = "identity")+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('Learning/Memory') + xlab('Abuse') + scale_fill_manual(values = c(rgb(145/255,69/255,93/255),rgb(206/255,118/255,119/255),rgb(227/255,180/255,150/255))) + geom_errorbar(aes(ymin=thompson_PC3-se, ymax=thompson_PC3+se), width=.2,position=position_dodge(.9))
# dev.off() 




# Print models to table
mod41<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+abuse_binary,data=abcd.data.train)
mod42<-lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+abuse_binary,data=abcd.data.train)
mod43<-lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+abuse_binary,data=abcd.data.train)
mod44<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+abuse_binary,data=abcd.data.test)
mod45<-lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+abuse_binary,data=abcd.data.test)
mod46<-lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+abuse_binary,data=abcd.data.test)
tab_model(mod41,mod42,mod43,pred.labels = c("Intercept","Age","Sex","Household Income [50K-100K]","Household Income [>100K]","Neighborhood Income","Parent Educ: HS Diploma/GED","Parent Educ: Some College","Parent Educ: Bachelor","Parent Educ: Post Graduate","Abuse"),dv.labels=c("General Cognition","Executive Function","Learning/Memory"),digits=2,digits.p=2,show.se=TRUE,show.stat=TRUE,string.stat = "t",string.se = "Std. Error",show.intercept=TRUE,show.ci = FALSE, p.adjust="bonferroni",p.style="scientific",file = "/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Abuse_Table_Train.doc")
tab_model(mod44,mod45,mod46,pred.labels = c("Intercept","Age","Sex","Household Income [50K-100K]","Household Income [>100K]","Neighborhood Income","Parent Educ: HS Diploma/GED","Parent Educ: Some College","Parent Educ: Bachelor","Parent Educ: Post Graduate","Abuse"),dv.labels=c("General Cognition","Executive Function","Learning/Memory"),digits=2,digits.p=2,show.se=TRUE,show.stat=TRUE,string.stat = "t",string.se = "Std. Error",show.intercept=TRUE,show.ci = FALSE, p.adjust="bonferroni",p.style="scientific", file = "/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Abuse_Table_Test.doc")



mod51<-lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+monitoring+abuse_binary,data=abcd.data.train)
mod52<-lmer(thompson_PC2~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+monitoring+abuse_binary,data=abcd.data.train)
mod53<-lmer(thompson_PC3~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+monitoring+abuse_binary,data=abcd.data.train)
tab_model(mod51,mod52,mod53,pred.labels = c("Intercept","Age","Sex","Household Income [50K-100K]","Household Income [>100K]","Neighborhood Income","Parent Educ: HS Diploma/GED","Parent Educ: Some College","Parent Educ: Bachelor","Parent Educ: Post Graduate","Caregiver Monitoring","Abuse"),dv.labels=c("General Cognition","Executive Function","Learning/Memory"),digits=2,digits.p=2,show.se=TRUE,show.stat=TRUE,string.stat = "t",string.se = "Std. Error",show.intercept=TRUE,show.ci = FALSE, p.adjust="bonferroni",p.style="scientific",file = "/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Abuse_Table_WithMonitoring_Train.doc")



```



# make some images showing the item-level analyses
```{r}

df.summary <- subset(abcd.data.traintest,!is.na(parent_monitor_q1_y)) %>%
     group_by(parent_monitor_q1_y) %>%
     summarise(
         se = sd(thompson_PC1, na.rm = TRUE)/sqrt(length(thompson_PC1)),
         thompson_PC1 = mean(thompson_PC1,na.rm=TRUE))
png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Item1_PC1_traintest.png",
    width = 4000,
    height = 2000,
    res=700)
ggplot(data=df.summary,aes(parent_monitor_q1_y,thompson_PC1,fill=as.factor(parent_monitor_q1_y)))+geom_bar(position = "dodge",stat = "identity")+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('General Cognition') + xlab('Item 1: Know where you are') + scale_fill_manual(values = sequential_hcl(5,"RedOr")) + geom_errorbar(aes(ymin=thompson_PC1-se, ymax=thompson_PC1+se), width=.2,position=position_dodge(.9))+coord_cartesian(ylim = c(-1.4, 0.2))
dev.off()


df.summary <- subset(abcd.data.traintest,!is.na(parent_monitor_q2_y)) %>%
     group_by(parent_monitor_q2_y) %>%
     summarise(
         se = sd(thompson_PC1, na.rm = TRUE)/sqrt(length(thompson_PC1)),
         thompson_PC1 = mean(thompson_PC1,na.rm=TRUE))
png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Item2_PC1_traintest.png",
    width = 4000,
    height = 2000,
    res=700)
ggplot(data=df.summary,aes(parent_monitor_q2_y,thompson_PC1,fill=as.factor(parent_monitor_q2_y)))+geom_bar(position = "dodge",stat = "identity")+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('General Cognition') + xlab('Item 2: Know who you are with') + scale_fill_manual(values = sequential_hcl(5,"RedOr")) + geom_errorbar(aes(ymin=thompson_PC1-se, ymax=thompson_PC1+se), width=.2,position=position_dodge(.9))+coord_cartesian(ylim = c(-0.75, 0.2))
dev.off()


df.summary <- subset(abcd.data.traintest,!is.na(parent_monitor_q3_y)) %>%
     group_by(parent_monitor_q3_y) %>%
     summarise(
         se = sd(thompson_PC1, na.rm = TRUE)/sqrt(length(thompson_PC1)),
         thompson_PC1 = mean(thompson_PC1,na.rm=TRUE))
png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Item3_PC1_traintest.png",
    width = 4000,
    height = 2000,
    res=700)
ggplot(data=df.summary,aes(parent_monitor_q3_y,thompson_PC1,fill=as.factor(parent_monitor_q3_y)))+geom_bar(position = "dodge",stat = "identity")+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('General Cognition') + xlab('Item 3: Know how to contact') + scale_fill_manual(values =sequential_hcl(5,"RedOr")) + geom_errorbar(aes(ymin=thompson_PC1-se, ymax=thompson_PC1+se), width=.2,position=position_dodge(.9))+coord_cartesian(ylim = c(-0.75, 0.2))
dev.off()


df.summary <- subset(abcd.data.traintest,!is.na(parent_monitor_q4_y)) %>%
     group_by(parent_monitor_q4_y) %>%
     summarise(
         se = sd(thompson_PC1, na.rm = TRUE)/sqrt(length(thompson_PC1)),
         thompson_PC1 = mean(thompson_PC1,na.rm=TRUE))
png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Item4_PC1_traintest.png",
    width = 4000,
    height = 2000,
    res=700)
ggplot(data=df.summary,aes(parent_monitor_q4_y,thompson_PC1,fill=as.factor(parent_monitor_q4_y)))+geom_bar(position = "dodge",stat = "identity")+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('General Cognition') + xlab('Item 4: Talk over plans') + scale_fill_manual(values = sequential_hcl(5,"RedOr")) + geom_errorbar(aes(ymin=thompson_PC1-se, ymax=thompson_PC1+se), width=.2,position=position_dodge(.9))+coord_cartesian(ylim = c(-0.75, 0.2))
dev.off()


df.summary <- subset(abcd.data.traintest,!is.na(parent_monitor_q5_y)) %>%
     group_by(parent_monitor_q5_y) %>%
     summarise(
         se = sd(thompson_PC1, na.rm = TRUE)/sqrt(length(thompson_PC1)),
         thompson_PC1 = mean(thompson_PC1,na.rm=TRUE))
png("/Users/askeller/Documents/Writing_InProgress/ParentalMonitoring_Cognition/Item5_PC1_traintest.png",
    width = 4000,
    height = 2000,
    res=700)
ggplot(data=df.summary,aes(parent_monitor_q5_y,thompson_PC1,fill=as.factor(parent_monitor_q5_y)))+geom_bar(position = "dodge",stat = "identity")+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) +ylab('General Cognition') + xlab('Item 5: Have dinner together') + scale_fill_manual(values = sequential_hcl(5,"RedOr")) + geom_errorbar(aes(ymin=thompson_PC1-se, ymax=thompson_PC1+se), width=.2,position=position_dodge(.9))+coord_cartesian(ylim = c(-0.75, 0.2))
dev.off()
```





### REPEAT ITEM-LEVEL ANALYSES SEPARATELY IN DISCOVERY AND REPLICATION SAMPLES
```{r}

abcd.data.train$parent_monitor_q1_y<-as.numeric(abcd.data.train$parent_monitor_q1_y)
abcd.data.train$parent_monitor_q2_y<-as.numeric(abcd.data.train$parent_monitor_q2_y)
abcd.data.train$parent_monitor_q3_y<-as.numeric(abcd.data.train$parent_monitor_q3_y)
abcd.data.train$parent_monitor_q4_y<-as.numeric(abcd.data.train$parent_monitor_q4_y)
abcd.data.train$parent_monitor_q5_y<-as.numeric(abcd.data.train$parent_monitor_q5_y)

abcd.data.test$parent_monitor_q1_y<-as.numeric(abcd.data.test$parent_monitor_q1_y)
abcd.data.test$parent_monitor_q2_y<-as.numeric(abcd.data.test$parent_monitor_q2_y)
abcd.data.test$parent_monitor_q3_y<-as.numeric(abcd.data.test$parent_monitor_q3_y)
abcd.data.test$parent_monitor_q4_y<-as.numeric(abcd.data.test$parent_monitor_q4_y)
abcd.data.test$parent_monitor_q5_y<-as.numeric(abcd.data.test$parent_monitor_q5_y)



summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+household.income+high.educ+parent_monitor_q1_y+parent_monitor_q2_y+parent_monitor_q3_y+parent_monitor_q4_y+parent_monitor_q5_y,data=abcd.data.train)) # all significant except Q3

summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+household.income+high.educ+parent_monitor_q1_y+parent_monitor_q2_y+parent_monitor_q3_y+parent_monitor_q4_y+parent_monitor_q5_y,data=abcd.data.test)) # all significant ***


# try the same thing but with the question number coded as a factor to look at an interaction
library("reshape2")

monitoring_qs <- abcd.data.train[,c("subjectkey","parent_monitor_q1_y","parent_monitor_q2_y","parent_monitor_q3_y","parent_monitor_q4_y","parent_monitor_q5_y")]
test<-melt(monitoring_qs)
merged.dataset.train<-merge(test,abcd.data.train,by="subjectkey")
merged.dataset.train$variable=as.factor(merged.dataset.train$variable)
summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+household.income+high.educ+value*variable,data=merged.dataset.train))

monitoring_qs <- abcd.data.test[,c("subjectkey","parent_monitor_q1_y","parent_monitor_q2_y","parent_monitor_q3_y","parent_monitor_q4_y","parent_monitor_q5_y")]
test<-melt(monitoring_qs)
merged.dataset.test<-merge(test,abcd.data.test,by="subjectkey")
merged.dataset.test$variable=as.factor(merged.dataset.test$variable)
summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+reshist_addr1_adi_income+household.income+high.educ+value*variable,data=merged.dataset.test))

```



## Analyses by Task
```{r}

# Equations pasted in here for reference:

# combined.data$thompson_PC1 <- (0.754*combined.data$PicVocab)+(0.213*combined.data$Flanker)+(0.471*combined.data$List)+(0.205*combined.data$CardSort)+(0.015*combined.data$Pattern)+(0.012*combined.data$Picture)+(0.82*combined.data$Reading)+(0.306*combined.data$RAVLT)+(0.5*combined.data$LMT)
# 
# combined.data$thompson_PC2 <- (0.065*combined.data$PicVocab)+(0.712*combined.data$Flanker)+(0.148*combined.data$List)+(0.71*combined.data$CardSort)+(0.813*combined.data$Pattern)+(0.135*combined.data$Picture)+(0.12*combined.data$Reading)+(0.125*combined.data$RAVLT)+(0.299*combined.data$LMT)
# 
# combined.data$thompson_PC3 <- (0.19*combined.data$PicVocab)+(0.067*combined.data$Flanker)+(0.493*combined.data$List)+(0.232*combined.data$CardSort)+(0.085*combined.data$Pattern)+(0.863*combined.data$Picture)+(0.122*combined.data$Reading)+(0.712*combined.data$RAVLT)+(0.068*combined.data$LMT)

summary(lmer(PicVocab~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.train)) # Warmth: ns / Montioring: ***
summary(lmer(Flanker~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.train)) # Warmth: ns / Montioring: ns
summary(lmer(List~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.train)) # Warmth:  ns / Montioring: ns
summary(lmer(CardSort~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.train)) # Warmth: ns / Montioring: ns
summary(lmer(Pattern~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.train)) # Warmth: ns / Montioring: ns
summary(lmer(Picture~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.train)) # Warmth: ns / Montioring: ns
summary(lmer(Reading~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.train)) # Warmth: ns / Montioring: ***
summary(lmer(RAVLT~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.train)) # Warmth: ns / Montioring: **
summary(lmer(LMT~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.train)) # Warmth: ns / Montioring: *


summary(lmer(PicVocab~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.test)) # Warmth: ns / Montioring: ***
summary(lmer(Flanker~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.test)) # Warmth: ns / Montioring: ns
summary(lmer(List~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.test)) # Warmth:  ** / Montioring: ***
summary(lmer(CardSort~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.test)) # Warmth: ns / Montioring: ***
summary(lmer(Pattern~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.test)) # Warmth: ns / Montioring: *
summary(lmer(Picture~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.test)) # Warmth: ns / Montioring: ns
summary(lmer(Reading~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.test)) # Warmth: ns / Montioring: ***
summary(lmer(RAVLT~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.test)) # Warmth: ns / Montioring: ***
summary(lmer(LMT~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+warmth+monitoring,data=abcd.data.test)) # Warmth: ns / Montioring: *

```


# Moderation analyses
```{r}
summary(lmer(thompson_PC1~interview_age+sex+(1|rel_family_id)+(1|abcd_site)+household.income+reshist_addr1_adi_income+high.educ+monitoring+monitoring*household.income,data=abcd.data.train))
```


# Compare excluded participants to included
```{r}
abcd.data.exclusion=abcd.data.almost
abcd.data.exclusion$exclusion=ifelse(abcd.data.exclusion$subjectkey %in% abcd.data.traintest$subjectkey,1,2)

library(Gmisc)
demo_table <- abcd.data.exclusion %>%
  mutate(exclusion = factor(exclusion, levels = 1:2, labels = c("Included", "Excluded"))) %>%
#subset(matched_group<3) %>%
  set_column_labels(interview_age = "Age (Months)",
                    sex = "Sex",
                    race.6level = "Race",
                    household.income = "Household Income",
                    reshist_addr1_adi_income = "Neighborhood Income",
                    high.educ = "Parent Education") %>%
getDescriptionStatsBy(interview_age, 
                        sex,
                        reshist_addr1_adi_income,
                        household.income,
                        race.6level,
                        high.educ,
                        add_total_col = TRUE, statistics=TRUE,
                        by = exclusion)

demo_table
```


<!-- # Calculate internal reliability using omega: -->
<!-- ```{r} -->
<!-- library(psych) -->
<!-- library(GPArotation) -->
<!-- monitoring_items <- as.matrix(data.frame(as.numeric(abcd.data.traintest$parent_monitor_q1_y),as.numeric(abcd.data.traintest$parent_monitor_q2_y),as.numeric(abcd.data.traintest$parent_monitor_q3_y),as.numeric(abcd.data.traintest$parent_monitor_q4_y),as.numeric(abcd.data.traintest$parent_monitor_q5_y))) -->
<!-- omega(cor(monitoring_items),nfactors = 1) -->

<!-- ``` -->



